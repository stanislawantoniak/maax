<?php /* @var $this Zolago_Banner_Block_Vendor_Banner_Edit */ ?>
<?php $_helper = Mage::helper("zolagobanner");?>
<?php $_model = $this->getModel();?>
<div class="container">
	<div class="page-heading row">
		<div class="col-lg-6">
			<h3>
				<?php if($this->isModelNew()):?>
					<?php echo Mage::helper("zolagobanner")->__("New Banner");?>
				<?php else: ?>
					<?php echo Mage::helper("zolagopo")->__("Edit Banner '%s'", $_model->getName());?>
				<?php endif;?>
			</h3>
		</div>
	</div>
    <div class="page-heading row">
        <div class="col-lg-6">
            <ol class="breadcrumb">
                <?php if($this->isModelNew()):?>
                    <li>
                        <a href="<?php echo $_helper->setBannerTypeUrl(); ?>">
                            <?php echo $_helper->__('Choose Banner Type') ?>
                        </a>
                    </li>
                <?php endif;?>
                <?php if($this->isModelNew()):?>
                    <li class="active"><?php echo $_helper->__("New Banner");?></li>
                <?php else: ?>
                    <li class="active"><?php echo $_helper->__("Edit Banner '%s'", $_model->getName());?></li>
                <?php endif;?>
            </ol>
        </div>
    </div>
</div>

<div class="container z-grid">
	<form id="edit-banner" class="form-horizontal row-border" action="<?php echo $this->getForm()->getAction();?>" method="POST" enctype="multipart/form-data">
		<input type="hidden" name="campaign_id" value="<?php echo $_model->getId();?>"/>
		<?php echo $this->getLayout()->getBlock('formkey')->toHtml();?>
		<?php echo $this->getForm()->toHtml();?>

		<div class="form-actions"> <input type="submit" value="<?php echo $_helper->__("Save");?>" class="btn btn-primary pull-right"> </div>
	</form>
</div>

<script type="text/javascript">
    jQuery(function ($) {
        var form = $("#edit-campaign");
        new Zolago.formIntegrator(form);
        form.validate();

        changeDependingSelector('slider_type');

        $("#add_slider").click(function(){
            var sliderNumber = $("[data-type=slider]").size();

            var template = '<div data-type=slider data-slidernumber='+sliderNumber+'>' +
                '<div class="form-group">' +
                '<a id="remove_slider" href="" style="position: relative;top: 10px;left: 60px;"><span class="glyphicon glyphicon-remove-circle"></span></a>' +
                '<a href="" id="add_slider_link"  style="float: right;position: absolute;right: 100px;"><span class="glyphicon glyphicon-plus"></span></a>' +
                '<div class="row"><label class="col-md-2 control-label"><label for="slider_image">Slider Image</label>' +
                '</label>' +
                '<div class="col-md-9"><input type="file" class="input-file" value="" name="slider['+sliderNumber+'][image]"></div></div>' +

                '<div data-type="url-container">' +
                '<div data-type="url-container-item">' +
                '<div class="row" ><label class="col-md-2 control-label"><label for="slider_link_url">Slider Link Url </label>' +
                '</label>' +
                '<div class="col-md-9"><input type="text" class="form-control input-text required-entry" value="" name="slider['+sliderNumber+'][0][ulr]">' +
                '</div></div>' +

                '<div class="row"><label class="col-md-2 control-label"><label for="slider_link_text">Slider Link Text </label>' +
                '</label>' +
                '<div class="col-md-9"><input type="text" class="form-control input-text required-entry" value="" name="slider['+sliderNumber+'][0][text]">' +
                '</div></div>' +

                '</div>' +
                '</div>' +
                '</div>' +
                '</div>';


            $(this).parents('.form-group').after(template);
            return false;
        })
        $(document.body).on('click', '#remove_slider', function(e){
            e.preventDefault();
            $(this).parents('[data-type=slider]').remove();

        })
        $(document.body).on('click', '#add_slider_link', function(e){
            e.preventDefault();
            var sliderNumber = $(this).parents("[data-type=slider]").data('slidernumber');
            var linksNumber = $(this).parents('[data-type=slider]').find('[data-type="url-container-item"]').size();
            console.log(sliderNumber);
            var template =
                '<div data-type="url-container-item">' +
                    '<a id="remove_slider_link" href="" style="float: right;position: relative;right: 100px;top: 25px;"><span class="glyphicon glyphicon-remove-circle"></span></a>' +
                '<div class="row"><label class="col-md-2 control-label"><label for="slider_link_url">Slider Link Url </label>' +
                '</label>' +
                '<div class="col-md-9"><input type="text" class="form-control input-text required-entry" value="" name="slider['+sliderNumber+']['+linksNumber+'][ulr]" >' +
                '</div></div>' +
                '<div class="row"><label class="col-md-2 control-label"><label for="slider_link_text">Slider Link Text </label>' +
                '</label>' +
                '<div class="col-md-9"><input type="text" class="form-control input-text required-entry" value="" name="slider['+sliderNumber+']['+linksNumber+'][text]" >' +
                '</div>' +
                    '</div>' +
                    '</div>';
                $(this).parents('[data-type=slider]').find('[data-type="url-container"]').append(template);
        })
        $(document.body).on('click', '#remove_slider_link', function(e){
            e.preventDefault();
            $(this).parents('[data-type=url-container-item]').remove();
        })

    });

    function changeDependingSelector(name) {
        jQuery('select[name=' + name + ']').change(function () {
            var form = jQuery('#edit-banner');
            var type = jQuery(this).val();
            form.find('[data-name=' + name + ']').addClass('hidden');
            form.find('[data-name=' + name + '][data-type=' + type + ']').removeClass('hidden');
        })
    }


</script>