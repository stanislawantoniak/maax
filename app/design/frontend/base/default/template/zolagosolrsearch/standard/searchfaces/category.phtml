<?php if($this->getParentBlock()->getMode()==Zolago_Solrsearch_Block_Faces::MODE_CATEGORY): ?>
	
	<?php $key = $this->getFacetKey(); ?>
	<?php if($this->getCanShow()): ?>
		<dt><?php echo $this->getFacetLabel(); ?></dt>
		<dd>
			<ul id="category-layered-nav" class="category">
			<?php foreach ($this->getAllItems() as $item=>$count):?>
				
				<li>
					<?php if (is_array($count)): ?>
						
						<div><?php echo $this->getItemText($item); ?>&nbsp;<span>(<?php echo $count['total'] ?>)</span></div>
						<ul>
							
							<?php foreach($count['children'] as $child_item=>$children_count): ?>
								
								<li><a href="<?php echo $this->getItemUrl($child_item) ?>" class=""><?php echo $this->getItemText($child_item); ?>&nbsp;<span>(<?php echo $children_count ?>)</span></a></li>
								
							<?php endforeach; ?>
							
						</ul>
						
					<?php else: ?>
						
						<?php if($this->getCanShowItem($item, $count)): ?>
							
							<a href="<?php echo $this->getItemUrl($item) ?>" class=""><?php echo $this->getItemText($item); ?>&nbsp;<span>(<?php echo $count ?>)</span></a>
							
						<?php endif;?>
						
					<?php endif; ?>
				</li>
				
			<?php endforeach;?>
			</ul>
		</dd>
	<?php endif; ?>
	
<?php elseif($this->getParentBlock()->getMode()==Zolago_Solrsearch_Block_Faces::MODE_SEARCH): ?>
	
	<?php $key = $this->getFacetKey(); ?>
	<?php if ($this->getCanShow()): ?>
		<dt id="solr_search_<?php echo $key ?>_expander" onclick="Effect.toggle('content_holder_<?php echo $key ?>', 'slide', {duration: 0.3});
				$('solr_search_<?php echo $key ?>_expander').toggleClassName('collapsed');
				return false;"><?php echo $this->getFacetLabel(); ?></dt>
		<dd id="content_holder_<?php echo $key ?>">
			<ol id="category-layered-nav" class="search">
			<?php foreach ($this->getAllItems() as $item=>$count):?>
				
				<?php if (is_array($count)): ?>
					
					<?php if($count['is_root_category']): ?>
						
						<?php foreach($count['children'] as $child_item=>$children_count): ?>
								
							<li><a href="<?php echo $this->getItemUrl($child_item) ?>" class=""><?php echo $this->getItemText($child_item); ?>&nbsp;<span>(<?php echo $children_count ?>)</span></a></li>
							
						<?php endforeach; ?>
						
					<?php else: ?>
						
						<li>
							<div><?php echo $this->getItemText($item); ?>&nbsp;<span>(<?php echo $count['total'] ?>)</span></div>
							<ul>
								
								<?php foreach($count['children'] as $child_item=>$children_count): ?>
									
									<li><a href="<?php echo $this->getItemUrl($child_item) ?>" class=""><?php echo $this->getItemText($child_item); ?>&nbsp;<span>(<?php echo $children_count ?>)</span></a></li>
									
								<?php endforeach; ?>
								
							</ul>
						</li>
						
					<?php endif; ?>
						
					
				<?php else: ?>
					
					<?php if($this->getCanShowItem($item, $count)): ?>
						
						<?php if ($this->isCategoryActive($item)): ?>				
						<li>					
							<strong><?php echo $this->getItemText($item); ?>&nbsp;<span>(<?php echo $count ?>)</span></strong>
						</li>
						<?php else: ?>
						<li>					
							<a href="<?php echo $this->getItemUrl($item) ?>" class="facet-item <?php echo $this->getItemClass($item); ?>"><?php echo $this->getItemText($item); ?>&nbsp;<span>(<?php echo $count ?>)</span></a>
						</li>
						<?php endif; ?>
						
					<?php endif;?>
					
				<?php endif; ?>
					
			<?php endforeach;?>
			</ol>
		</dd>
	<?php endif; ?>
	
<?php endif; ?>
