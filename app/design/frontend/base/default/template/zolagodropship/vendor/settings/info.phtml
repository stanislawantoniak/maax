<?php
/** @var Zolago_Dropship_Block_Vendor_Preferences $this */
/** @var Zolago_Dropship_Helper_Data $helper */
$helper = Mage::helper("zolagodropship");
/** @var Zolago_Dropship_Model_Session $_session */
$_session = Mage::getSingleton('udropship/session');
/** @var Zolago_Dropship_Model_Vendor $_vendor */
$_vendor = $_session->getVendor();
$_errorData = $_session->getData('vendorSettings') ? $_session->getData('vendorSettings') : array();
if(count($_errorData)) {
	$_session->unsetData('vendorSettings');
}
?>
<div class="container">
    <!--=== Page Header ===-->
    <div class="page-header">
        <div class="page-title">
            <h3><?php echo $helper->__("Company settings");?></h3>
        </div>
    </div>
    <div class="row">
        <div class="col-md-12">
            <form id="vendor_contact" class="form-horizontal" method="post" action="/udropship/vendor_settings/infoPost">
                <div class="widget box">
                    <div class="widget-header">
                        <h4><?php echo $helper->__("Company data"); ?></h4>
                    </div>
                    <div class="widget-content">

                        <div class="form-group">
                            <label for="company_name" class="col-md-3 control-label">
                                <?php echo $helper->__("Company name"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $companyName = isset($_errorData['company_name']) ? $_errorData['company_name'] : $_vendor->getCompanyName(); ?>
                                <input id="company_name" name="company_name" value="<?php echo $companyName; ?>" type="text" required
                                       class="form-control" size="10">
                            </div>
                        </div>

                        <div class="form-group">
                            <label for="billing_street" class="col-md-3 control-label">
                                <?php echo $helper->__("Street and Number"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $billing_street = isset($_errorData['billing_street']) ? $_errorData['billing_street'] : $_vendor->getBillingStreet(1); ?>
                                <input id="billing_street" name="billing_street" value="<?php echo $billing_street; ?>" type="text"
                                       required class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="billing_city" class="col-md-3 control-label">
                                <?php echo $helper->__("City"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $billing_city = isset($_errorData['billing_city']) ? $_errorData['billing_city'] : $_vendor->getBillingCity(); ?>
                                <input id="billing_city" name="billing_city" value="<?php echo $billing_city; ?>" required type="text"
                                       class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="billing_zip" class="col-md-3 control-label">
                                <?php echo $helper->__("Zip / Postal code"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $billing_zip = isset($_errorData['billing_zip']) ? $_errorData['billing_zip'] : $_vendor->getBillingZip(); ?>
                                <input id="billing_zip" name="billing_zip" value="<?php echo $billing_zip; ?>" required type="text"
                                       class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="tax_no" class="col-md-3 control-label">
                                <?php echo $helper->__("Tax identification no"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $tax_no = isset($_errorData['tax_no']) ? $_errorData['tax_no'] : $_vendor->getTaxNo(); ?>
                                <input id="tax_no" name="tax_no" value="<?php echo $tax_no; ?>" required type="text" class="form-control"
                                       size="10">
                            </div>
                        </div>

                    </div>
                </div>

                <div class="widget box">
                    <div class="widget-header">
                        <h4><?php echo $helper->__("Company contact data"); ?></h4>

                    </div>
                    <div class="widget-content fiters">
                        <div class="form-group">
                            <label for="www" class="col-md-3 control-label">
                                <?php echo $helper->__("WWW"); ?>
                            </label>

                            <div class="col-md-9">
	                            <?php $www = isset($_errorData['www']) ? $_errorData['www'] : $_vendor->getWww(); ?>
                                <input id="www" name="www" value="<?php echo $www; ?>" type="text" class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="contact_email" class="col-md-3 control-label">
                                <?php echo $helper->__("Email"); ?>
                            </label>

                            <div class="col-md-9">
	                            <?php $contact_email = isset($_errorData['contact_email']) ? $_errorData['contact_email'] : $_vendor->getContactEmail(); ?>
                                <input id="contact_email" name="contact_email" value="<?php echo $contact_email; ?>" type="text" class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="contact_telephone" class="col-md-3 control-label">
                                <?php echo $helper->__("Phone"); ?>
                            </label>

                            <div class="col-md-9">
	                            <?php $contact_telephone = isset($_errorData['contact_telephone']) ? $_errorData['contact_telephone'] : $_vendor->getData('contact_telephone'); ?>
                                <input id="contact_telephone" name="contact_telephone" value="<?php echo $contact_telephone; ?>" type="text" class="form-control" size="10">
                            </div>
                        </div>
                    </div>
                </div>

                <div class="widget box">
                    <div class="widget-header">
                        <h4><?php echo $helper->__("Executive contact (business)"); ?></h4>

                    </div>
                    <div class="widget-content">
                        <div class="form-group">
                            <label for="executive_firstname" class="col-md-3 control-label">
                                <?php echo $helper->__("Name"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $executive_firstname = isset($_errorData['executive_firstname']) ? $_errorData['executive_firstname'] : $_vendor->getData('executive_firstname'); ?>
                                <input id="executive_firstname" name="executive_firstname" required value="<?php echo $executive_firstname; ?>" type="text"
                                       class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="executive_lastname" class="col-md-3 control-label">
                                <?php echo $helper->__("Surname"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $executive_lastname = isset($_errorData['executive_lastname']) ? $_errorData['executive_lastname'] : $_vendor->getData('executive_lastname'); ?>
                                <input id="executive_lastname" name="executive_lastname" required value="<?php echo $executive_lastname; ?>" type="text"
                                       class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="executive_telephone" class="col-md-3 control-label">
                                <?php echo $helper->__("Phone "); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $executive_telephone = isset($_errorData['executive_telephone']) ? $_errorData['executive_telephone'] : $_vendor->getData('executive_telephone'); ?>
                                <input id="executive_telephone" name="executive_telephone" required value="<?php echo $executive_telephone; ?>" type="text"
                                       class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="executive_telephone_mobile" class="col-md-3 control-label">
                                <?php echo $helper->__("Mobile"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $executive_telephone_mobile = isset($_errorData['executive_telephone_mobile']) ? $_errorData['executive_telephone_mobile'] : $_vendor->getData('executive_telephone_mobile'); ?>
                                <input id="executive_telephone_mobile" name="executive_telephone_mobile" required value="<?php echo $executive_telephone_mobile; ?>"
                                       type="text" class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="billing_email" class="col-md-3 control-label">
                                <?php echo $helper->__("Email"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $billing_email = isset($_errorData['billing_email']) ? $_errorData['billing_email'] : $_vendor->getData('billing_email'); ?>
                                <input id="billing_email" name="billing_email" required value="<?php echo $billing_email; ?>" type="text"
                                       class="form-control" size="10">
                            </div>
                        </div>
                    </div>
                </div>
                <?php if(!$this->isOperatorMode()): ?>
                <div class="widget box">
                    <div class="widget-header">
                        <h4><?php echo $helper->__("Administrator contact (ITC or business)"); ?></h4>

                    </div>
                    <div class="widget-content">
                        <div class="form-group">
                            <label for="administrator_firstname" class="col-md-3 control-label">
                                <?php echo $helper->__("Name"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $administrator_firstname = isset($_errorData['administrator_firstname']) ? $_errorData['administrator_firstname'] : $_vendor->getData('administrator_firstname'); ?>
                                <input id="administrator_firstname" name="administrator_firstname" required value="<?php echo $administrator_firstname; ?>"
                                       type="text" class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="administrator_lastname" class="col-md-3 control-label">
                                <?php echo $helper->__("Surname"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $administrator_lastname = isset($_errorData['administrator_lastname']) ? $_errorData['administrator_lastname'] : $_vendor->getData('administrator_lastname'); ?>
                                <input id="administrator_lastname" name="administrator_lastname" required value="<?php echo $administrator_lastname; ?>"
                                       type="text" class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="administrator_telephone" class="col-md-3 control-label">
                                <?php echo $helper->__("Phone "); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $administrator_telephone = isset($_errorData['administrator_telephone']) ? $_errorData['administrator_telephone'] : $_vendor->getData('administrator_telephone'); ?>
                                <input id="administrator_telephone" name="administrator_telephone" required value="<?php echo $administrator_telephone; ?>"
                                       type="text" class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="administrator_telephone_mobile" class="col-md-3 control-label">
                                <?php echo $helper->__("Mobile"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $administrator_telephone_mobile = isset($_errorData['administrator_telephone_mobile']) ? $_errorData['administrator_telephone_mobile'] : $_vendor->getData('administrator_telephone_mobile'); ?>
                                <input id="administrator_telephone_mobile" name="administrator_telephone_mobile" required
                                       value="<?php echo $administrator_telephone_mobile; ?>" type="text" class="form-control" size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="email" class="col-md-3 control-label">
                                <?php echo $helper->__("Email (default login)"); ?>
                                <span class="required">*</span>
                            </label>

                            <div class="col-md-9">
	                            <?php $email = isset($_errorData['email']) ? $_errorData['email'] : $_vendor->getEmail(); ?>
                                <input id="email" name="email" required
                                       value="<?php echo $email; ?>" type="text" class="form-control"
                                       size="10">
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="password" class="col-md-3 control-label">
                                <?php echo $helper->__("New Password"); ?>
                            </label>

                            <div class="col-md-9">
                                <input id="password" name="password" value="" type="password" class="form-control"
                                       size="10">
                                <p>
                                    <span class="glyphicon glyphicon-exclamation-sign"></span>
                                    <?php echo $helper->__("Leave empty for no change"); ?>
                                </p>
                            </div>
                        </div>
                        <div class="form-group">
                            <label for="password_repeat" class="col-md-3 control-label">
                                <?php echo $helper->__("Repeat New Password"); ?>
                            </label>

                            <div class="col-md-9">
                                <input id="password_repeat" name="password_repeat" value="" type="password"
                                       class="form-control" size="10">
                            </div>
                        </div>
                    </div>
                </div>
                <?php endif; ?>
                <div class="form-actions">
                    <button type="reset" id="filter_reset" class="btn pull-right">
                        <span><span><?php echo $this->__('Cancel'); ?></span></span>
                    </button>
                    <button type="submit" id="filter_submit" class="btn btn-primary pull-right">
                        <span><span><?php echo $this->__('Save'); ?></span></span>
                    </button>
                </div>
            </form>
        </div>
    </div>
</div>
<script type="text/javascript">
    jQuery(function ($) {
        var form = $("#vendor_contact");
        new Zolago.formIntegrator(form);
        form.validate({
            rules: {
                password: {
                    minlength: 6
                },
                password_repeat: {
                    equalTo: "#password"
                },
                email: {
                    required: true,
                    email: true
                },
                billing_email: {
                    required: true,
                    email: true
                },

                contact_email: {
                    email: true
                },
                billing_zip: "postcodeWithReplace",
                tax_no: "validate-nip",
                contact_telephone: "validate-telephone",
                executive_telephone: "validate-telephone",
                executive_telephone_mobile: "validate-telephone",
                administrator_telephone: "validate-telephone",
                administrator_telephone_mobile: "validate-telephone"
            },
            messages: {
                password_repeat: {
                    "equalTo" : "<?php echo $this->__("Please enter the same value again.")?>"
                },
                email: {
                    "email" : "<?php echo $this->__("Please enter a valid email address. For example johndoe@domain.com.")?>"
                },
                billing_email: {
                    "email" : "<?php echo $this->__("Please enter a valid email address. For example johndoe@domain.com.")?>"
                },

                contact_email: {
                    "email" : "<?php echo $this->__("Please enter a valid email address. For example johndoe@domain.com.")?>"
                },
                password: {
                    "minlength" : "<?php echo $this->__("Password needs to have at least %s characters", Mage::helper("zolagocustomer")->getPasswordMinLength()); ?>"
                },
                tax_no: {
                    "validate-nip" : "<?php echo $this->__("Tax number is incorrect. Enter as a string of digits e.g. 1234567890.")?>"
                },
                billing_zip : {
                    'postcodeWithReplace': "<?php echo $this->__("Invalid zip-code. Zip-code should include 5 numbers in XX-XXX format."); ?>"
                },
                contact_telephone: {
                    "validate-telephone": "<?php echo $this->__("Telephone number is too short. Number must contain 9 digits, without spacing."); ?>"
                },
                executive_telephone: {
                    "validate-telephone": "<?php echo $this->__("Telephone number is too short. Number must contain 9 digits, without spacing."); ?>"
                },
                executive_telephone_mobile: {
                    "validate-telephone": "<?php echo $this->__("Telephone number is too short. Number must contain 9 digits, without spacing."); ?>"
                },
                administrator_telephone: {
                    "validate-telephone": "<?php echo $this->__("Telephone number is too short. Number must contain 9 digits, without spacing."); ?>"
                },
                administrator_telephone_mobile: {
                    "validate-telephone": "<?php echo $this->__("Telephone number is too short. Number must contain 9 digits, without spacing."); ?>"
                }
            }
        });
    });
</script>