<?php /* @var $this Zolago_Po_Block_Vendor_Po_Edit */ ?>
<?php $_po = $this->getPo(); ?>
<?php $_shipping = $this->getShippingMethod();?>
<div class="container">
	<!--=== Page Header ===-->
	<div class="page-header">
		<div class="page-title">
			<h3><?php echo Mage::helper("zolagopo")->__("Order #%s", $_po->getIncrementId());?></h3>
			<span><?php echo Mage::helper("zolagopo")->__("Order details");?></span>
		</div>
	</div>
</div>
<div class="container">
	<div class="row">
		<div class="col-md-4">
			<div class="widget box">
				<div class="widget-header"> 
					<h4>
						<i class="icon-info"></i> 
						<?php echo Mage::helper("zolagopo")->__("General");?>
					</h4>
					<div class="toolbar no-padding"> 
						<div class="btn-group"> 
							<span class="btn btn-xs">
								<i class="icon-retweet"></i> 
								<?php echo Mage::helper("zolagopo")->__("Change POS");?>
							</span> 
						</div> 
					</div>
				</div>
				<div class="widget-content orders">
					<dl class="dl-horizontal dl-z"> 
						<dt><?php echo Mage::helper("zolagopo")->__("Number");?>:</dt> 
						<dd><?php echo $_po->getIncrementId();?></dd> 
						<dt><?php echo Mage::helper("zolagopo")->__("Status");?>:</dt> 
						<dd>
							<div class="btn-group"> 
								<button class="btn btn-xs dropdown-toggle" data-toggle="dropdown"> 
									<?php echo $this->getCurrentStatus($_po);?> <span class="caret"></span> 
								</button> 
								<ul class="dropdown-menu"> 
									<?php foreach($this->getAllowedStatusesForPo($_po) as $key=>$status):?>
									<li><a href="#<?php echo $key;?>"><?php echo $status;?></a></li> 
									<?php endforeach;?>
								</ul> 
							</div>
						</dd> 
						<dt><?php echo Mage::helper("zolagopo")->__("Order date");?>:</dt> 
						<dd><?php echo Mage::helper('core')->formatDate($_po->getCreatedAt(), 'medium')?></dd> 
						<dt><?php echo Mage::helper("zolagopo")->__("Max. order date");?>:</dt> 
						<dd><?php echo Mage::helper('core')->formatDate($_po->getCreatedAt(), 'medium')?></dd> 
						<?php if($_po->getPos()):?>
						<dt><?php echo Mage::helper("zolagopo")->__("POS");?>:</dt> 
						<dd><?php echo $_po->getPos()->getName(); ?></dd> 
						<?php endif;?>
					</dl>
					<p class="alert alert-danger fade in"><?php echo Mage::helper("zolagopo")->__("Lorem ipsum dolor sit ament...");?></p>
				</div>
			</div>
		</div>
		<div class="col-md-4">
			<div class="widget box">
				<div class="widget-header"> <h4><i class="icon-usd"></i> <?php echo Mage::helper("zolagopo")->__("Payment");?></h4> </div>
				<div class="widget-content orders">
					<dl class="dl-horizontal dl-z"> 
						<dt><?php echo Mage::helper("zolagopo")->__("Payment status");?>:</dt> 
						<dd>Op≈Çacono</dd> 
						<dt><?php echo Mage::helper("zolagopo")->__("Paid");?>:</dt> 
						<dd>1 034,00 PLN</dd> 
						<dt><?php echo Mage::helper("zolagopo")->__("Debt");?>:</dt> 
						<dd> 34,00 PLN</dd> 
					</dl>
				</div>
			</div>
		</div>
		<div class="col-md-4">
			<div class="widget box">
				<div class="widget-header"> 
					<h4>
						<i class="icon-phone"></i> 
							<?php echo Mage::helper("zolagopo")->__("Contact");?>
					</h4> 
					<div class="toolbar no-padding"> 
						<div class="btn-group"> 
							<span class="btn btn-xs">
								<i class="icon-comment "></i> 
								<?php echo Mage::helper("zolagopo")->__("Compose");?>
							</span> 
							<span class="btn btn-xs">
								<i class="icon-envelope "></i>
								<span class="label label-danger">5</span>
							</span> 
							
						</div> 
					</div>
				</div>
				<div class="widget-content orders">
					<dl class="dl-horizontal dl-z"> 
						<dt><?php echo Mage::helper("zolagopo")->__("Fullname");?>:</dt> 
						<dd><?php echo $this->escapeHtml($_po->getBillingAddress()->getName());?></dd> 
						<dt><?php echo Mage::helper("zolagopo")->__("Phone");?>:</dt> 
						<dd><?php echo $this->escapeHtml($_po->getBillingAddress()->getTelephone());?></dd> 
						<dt><?php echo Mage::helper("zolagopo")->__("All messages");?></dt> 
						<dd>120</dd> 
<!--						<dt><button class="btn btn-xs btn-default"><i class="icon-envelope-alt"></i> <?php echo Mage::helper("zolagopo")->__("Compose");?></button></dt> 
						<dd></dd> -->
					</dl>
				</div>
			</div>
		</div>
	</div>
</div>

<div class="container">
	<div class="row">
		<div class="col-md-12">
			<div class="widget box">
				<div class="widget-header"> 
					<h4>
						<i class="icon-list"></i> 
						<?php echo Mage::helper("zolagopo")->__("Order items");?>
					</h4> 
				</div>
				
				<div class="widget-content  no-padding">
					<table class="table table-striped table-bordered table-checkable table-hover foot-empty-cells">
						<colgroup>
							<col width="50px"/>
							<col width="50px"/>
							<col width="150px"/>
							<col/>
							<col width="50px"/>
							<col width="100px"/>
							<col width="100px"/>
							<col width="100px"/>
							<col width="100px"/>
							<col width="145px"/>
						</colgroup>
						<thead>
							<tr>
								<th class="align-center"><?php echo Mage::helper("zolagopo")->__("Check");?></th>
								<th class="align-right"><?php echo Mage::helper("zolagopo")->__("LP");?></th>
								<th><?php echo Mage::helper("zolagopo")->__("SKU");?></th>
								<th><?php echo Mage::helper("zolagopo")->__("Product");?></th>
								<th class="align-right"><?php echo Mage::helper("zolagopo")->__("Qty");?></th>
								<th class="align-right"><?php echo Mage::helper("zolagopo")->__("Price incl. tax");?></th>
								<th class="align-right"><?php echo Mage::helper("zolagopo")->__("Discount");?></th>
								<th class="align-right"><?php echo Mage::helper("zolagopo")->__("Final price");?></th>
								<th class="align-right"><?php echo Mage::helper("zolagopo")->__("POS Qty");?></th>
								<th></th>
							</tr>
						</thead>
						<tfoot>
							<tr>
								<td colspan="3"></td>
								<?php if($_shipping):?>
								<td colspan="2"><?php echo Mage::helper("zolagopo")->__("Shipping");?>:<?php echo $this->escapeHtml($this->getMethodName($_shipping));?></td>
								<td class="align-right"><?php echo Mage::helper("core")->currency($_po->getBaseShippingAmountInclTax(), true, false);?></td>
								<td class="align-right"><?php echo Mage::helper("core")->currency($_po->getShippingDiscountInclTax(), true, false);?></td>
								<td class="align-right"><?php echo Mage::helper("core")->currency($_po->getFinalShippingAmountInclTax(), true, false);?></td>
								<?php else:?>
								<td colspan="5"></td>
								<?php endif;?>
								<td ></td>
								<td>
									<button class="btn btn-xs" >
										<i class="icon-edit"></i>
										<?php echo Mage::helper("zolagopo")->__("Edit item");?>
									</button>
									<button class="btn btn-xs btn-notification" data-layout="top" data-type="confirm" data-text="<?php echo Mage::helper("zolagopo")->__("Do you want to remove this item?");?>" data-modal="true">
										<i class="icon-remove"></i>
									</button>
								</td>
							</tr>
							<tr>
								<td colspan="3"></td>
								<td colspan="4"><strong> <?php echo Mage::helper("zolagopo")->__("Total");?></strong></td>
								<td class="align-right"><strong><?php echo Mage::helper("core")->currency($_po->getGrandTotalInclTax());?></strong></td>
								<td> </td>
							</tr>
						</tfoot>
						<tbody>
							<?php $i=0;?>
							<?php foreach($_po->getAllItems() as $_key=>$_item): ?>
								<?php if(!$_item->getOrderItem()->getParentItemId()):?>
									<?php echo $this->getItemRedener($_item)->setLp(++$i)->toHtml();?>
								<?php endif;?>
							<?php endforeach;?>
						</tbody>
					</table>
				</div>
			</div>
		</div>
	</div>
	<div class="row">
		<div class="col-md-2">
			<div class="widget">
				<button class="btn btn-block">
					<i class="icon-ok"></i>
					<?php echo Mage::helper("zolagopo")->__("Confirm Backorder");?>
				</button>
			</div>
		</div>

		<div class="col-md-2">
			<div class="widget">
				<button class="btn btn-block">
					<i class="icon-retweet"></i>
					<?php echo Mage::helper("zolagopo")->__("Change POS");?>
				</button>
			</div>
		</div>
		<div class="col-md-2">
			<div class="widget">
				<button class="btn btn-block">
					<i class=" icon-copy"></i>
					<?php echo Mage::helper("zolagopo")->__("Split order");?>
				</button>
			</div>
		</div>
		<div class="col-md-2 col-md-offset-4">
			<div class="widget">
				<button class="btn btn-block" >
					<i class="icon-plus-sign"></i>
					<?php echo Mage::helper("zolagopo")->__("Add new item");?>
				</button>
			</div>
		</div>
	</div>
	<div class="row next-row">
		<div class="col-md-3">
			<div class="widget box">
				<div class="widget-header">
					<h4>
						<i class=" icon-envelope"></i> 
						<?php echo Mage::helper("zolagopo")->__("Shipping address");?>
					</h4>			
					<div class="toolbar no-padding"> 
						<div class="btn-group"> 
							<span class="btn btn-xs"><i class="icon-pencil"></i></span> 
						</div> 
					</div>
				</div>
				<div class="widget-content">
					<?php echo Mage::helper('udropship')->formatCustomerAddress($_po->getShippingAddress(), 'html', $this->getVendor()) ?>
				</div>
			</div>
		</div>
		<div class="col-md-3">
			<div class="widget box">
				<div class="widget-header">
					<h4>
						<i class="icon-file"></i> 
						<?php echo Mage::helper("zolagopo")->__("Sale document");?>
					</h4>
					<div class="toolbar no-padding"> 
						<div class="btn-group"> 
							<span class="btn btn-xs"><i class="icon-pencil"></i></span> 
						</div> 
					</div>
				</div>
				<div class="widget-content">
					<?php echo Mage::helper('udropship')->formatCustomerAddress($_po->getBillingAddress(), 'html', $this->getVendor()) ?>
				</div>
			</div>
		</div>
		<div class="col-md-6">
			<div class="widget box">
				<div class="widget-header">
					<h4>
						<i class="icon-plane"></i> 
						<?php echo Mage::helper("zolagopo")->__("Shipment");?>
					</h4>		
				</div>
				<div class="widget-content">
					Addr
				</div>
			</div>
		</div>
	</div>
</div>
<script type="text/javascript">
	jQuery(function($){
		$('.btn-notification').click(function() {
			var self = $(this);
			noty({
				text: self.data('text'),
				type: self.data('type'),
				modal: self.data('modal'),
				layout: self.data('layout'),
				buttons: (self.data('type') != 'confirm') ? false : [
					{
						addClass: 'btn btn-primary', text: 'Ok', onClick: function($noty) {
							$noty.close();
							noty({force: true, timeout: 2000, text: 'You clicked "Ok" button', type: 'success', layout: self.data('layout')});
						}
					}, {
						addClass: 'btn btn-danger', text: 'Cancel', onClick: function($noty) {$noty.close();}
					}
				]
			});

			return false;
		});
	});
</script>