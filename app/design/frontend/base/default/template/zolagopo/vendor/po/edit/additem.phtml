<?php /* @var $this Zolago_Po_Block_Vendor_Po_Edit_Additem  */?>
<?php $_hlp = Mage::helper("zolagopo");?>
<?php $_po =  $this->getPo();?>
<!-- Modal add letter-->
<div class="modal fade" id="addItemModal">
	<div class="modal-dialog">
		<form id="shipping-form" action="<?php echo $this->getPoUrl("addItem");?>" 
			  class="form-horizontal row-border" method="post">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
					<h4 class="modal-title">
						<?php echo $_hlp->__("Add item");?>
					</h4>
				</div>
				<div class="modal-body">
					<ul class="list-unstyled">
						<li class="form-group">
							<div class="col-md-12">
								<input name="product" data-placeholder="<?php echo $_hlp->__('Choose a product') ?>" id="additem-product" class="select2-select-00 col-md-12 full-width-fix" type="hidden"/>
							</div>
						</li>
<!--						<li class="form-group">
							<label for="additem-product" class="col-md-3 control-label"><?php echo $_hlp->__('Product') ?></label>
							<div class="col-md-9">
								<select name="product" id="additem-product" class="form-control">
									<option value="">Select</option>
								</select>
							</div>
						</li>-->
					</ul>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal"><?php echo $_hlp->__("Cancel");?></button>
					<button type="submit" name="add_own" value="1" class="btn form-btn-loading btn-primary" data-loading-text="<?php echo $_hlp->__("Loading...");?>"><?php echo $_hlp->__("Add item");?></button>
				</div>
			</div>
		</form>
	</div>
</div>

<script src="<?php echo $this->getSkinUrl("js/plugins/select2/select2.min.js");?>" type="text/javascript"></script>

<script type="text/javascript">
jQuery(function($){
	var formatSelection = function(item) { return item.name; }
	var formatResult = function(item) { return item.name + " (" + item.sku +  ")"; }
	$("#additem-product").select2({
		data:				<?php echo $this->getProductCollectionJson();?>,
		id:					"entity_id",
		text:				"name",
		formatSelection:	formatSelection,
		formatResult:		formatResult,
		matcher: function(term, text, opts) { 
			return (''+opts.name).toUpperCase().indexOf((''+term).toUpperCase()) >= 0 || 
				   (''+opts.sku).toUpperCase().indexOf((''+term).toUpperCase()) >= 0
		}
	});
});
</script>