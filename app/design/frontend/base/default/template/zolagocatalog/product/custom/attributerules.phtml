<?php
/** @var GH_AttributeRules_Block_Attribute $this */

/** @var GH_AttributeRules_Helper_Data $helper */
$helper = Mage::helper("gh_attributerules");

/** @var Zolago_Common_Helper_Data $_zolagoHlp */
$_modagoHlp = Mage::helper("zolagocommon");
?>

<style>
    #showAttributeRules .hiddenRow.in {
        display: table-cell !important
    }
    #showAttributeRules table.table {
        margin-bottom: 0 !important;
    }
</style>

<div class="modal fade bs-example-modal-sm" id="showAttributeRules" role="dialog">
    <form method="post" action="<?php echo $this->getActionUrl();?>">
        <div class="modal-dialog modal-sm" style="width: 80%;">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title"><?php echo $helper->__("Manage attributes rules"); ?></h4>
                </div>
                <div class="modal-body">
                    <p class="alert alert-info">
                        <strong><?php echo $helper->__("Information");?>:</strong>
                        <?php echo $helper->__("Some text here");?>
                    </p>
                    <div class="widget-content">
                        <table
                            class="table table-bordered table-checkable table-highlight-head table-no-inner-border table-hover">
                            <thead>
                            <tr>
                                <th class="checkbox-column" style="width: 3%;"></th>
                                <th class="align-center" style="width: 8%;"><?php echo $helper->__("Show more"); ?></th>
                                <th><?php echo $helper->__("Attribute"); ?></th>
                            </tr>
                            </thead>
                            <tbody>
                            <?php
                            foreach ($this->getRulesData() as $key => $row): ?>
                            <tr class="">
                                <td class="checkbox-column">
                                    <div class="checker"><span class=""><input type="checkbox" class="uniform"></span></div>
                                </td>
                                <td class="show-more-collumn align-center accordion-toggle" data-toggle="collapse" data-target="#row-<?php echo $key; ?>" style="cursor: pointer;">
                                    <span class="btn btn-xs"><i class="icon-plus"></i></span>
                                </td>
                                <td class="attribute-column accordion-toggle" data-toggle="collapse" data-target="#row-<?php echo $key; ?>" style="cursor: pointer;">
                                    <?php
                                    /** @var Mage_Catalog_Model_Resource_Eav_Attribute $attr */
                                    $attr = $row['attribute'];
                                    echo $attr->getName();
                                    ?>
                                </td>
                            </tr>
                            <tr>

                                <td colspan="3" style="padding: 0;" id="row-<?php echo $key; ?>" class="body-lvl-1 accordian-body collapse hiddenRow">
                                    <div>
                                        <table class="table table-bordered table-checkable table-no-inner-border table-hover">
                                            <thead>
                                            <tr>
                                                <th class="lvl-1-thead-prefix" style="width: 11%;"></th>
                                                <th class="checkbox-column" style="width: 3%;"></th>
                                                <th class="" style="width: 8%;"><?php echo $helper->__("Show more"); ?></th>
                                                <th><?php echo $helper->__("Value"); ?></th>
                                            </tr>
                                            </thead>
                                            <tbody>
                                            <?php
                                            /** @var GH_AttributeRules_Model_AttributeRule $rule */
                                            foreach ($row['rule'] as $rule): ?>
                                                <tr>
                                                    <td><!-- prefix --></td>
                                                    <td class="checkbox-column">
                                                        <div class="checker"><span class=""><input type="checkbox" class="uniform"></span></div>
                                                    </td>
                                                    <td class="show-more-collumn align-center accordion-toggle" data-toggle="collapse" data-target="#rule-<?php echo $rule->getId(); ?>" style="cursor: pointer;">
                                                        <span class="btn btn-xs"><i class="icon-plus"></i></span>
                                                    </td>
                                                    <td>
                                                        <?php echo $rule->getValue(); ?>
                                                    </td>
                                                </tr>
                                            <?php endforeach; ?>
                                            </tbody>
                                        </table>
                                    </div>
                                </td>
                            </tr>

                            <?php endforeach; ?>
                            </tbody>
                        </table>
                    </div>


                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-default" data-dismiss="modal"><?php echo $helper->__("Cancel"); ?></button>
                    <button type="submit" class="btn btn-primary" data-loading-text="<?php echo $_modagoHlp->__("Processing...");?>"><?php echo $helper->__('Action'); ?></button>
                </div>
            </div>
        </div>
    </form>
</div>

<script>
    var attributeRules = {
        init: function() {

        },

        getModal: function() {
            return jQuery('#showAttributeRules');
        }
    };

    jQuery(document).ready(function() {
        attributeRules.init();
    });
</script>