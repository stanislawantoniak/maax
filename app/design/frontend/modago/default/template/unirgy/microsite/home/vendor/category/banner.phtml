<?php
/**
 * Inspiration block on Gallery Home Page
 */
/** @var Zolago_Modago_Block_Dropshipmicrositepro_Vendor_Category_Banner $this */

$sliderType = Zolago_Banner_Model_Banner_Type::TYPE_SLIDER;
$boxType = Zolago_Banner_Model_Banner_Type::TYPE_BOX;
$inspirationType = Zolago_Banner_Model_Banner_Type::TYPE_INSPIRATION;
$inspirations = $this->getInspirations();
$landingPageHelper = Mage::helper("zolagocampaign/landingPage");
/** @var Zolago_Banner_Helper_Data $bannerHelper */
$bannerHelper = Mage::helper("zolagobanner");

?>

<?php if ($inspirations): // 1 START ?>
<div class="row">
    <section class="block-inspiration">
        <header class="title-section">
            <div class="inspiration-strips "></div>
            <h2 ><?php echo $bannerHelper->__("inspirations"); ?></h2>
        </header>
        <div id="rwd-inspiration" class="rwdCarousel">
            <div class="rwd-carousel rwd-theme">
                <?php foreach($inspirations as $n => $inspiration): // 2 START ?>
                    <?php $inspiratio = empty($inspiration['banner_image']) ?array():unserialize($inspiration['banner_image']); ?>
                    <?php $captions = empty($inspiration['banner_caption'])? array():unserialize($inspiration['banner_caption']); ?>
                    <?php if(!empty($inspiratio)): // 3 START ?>
                        <?php foreach($inspiratio as $i => $insp): // 4 START ?>

                            <?php $urlText = $landingPageHelper->getLandingPageUrl($inspiration['campaign_id']); ?>
                            <?php $campaignUrl = !empty($urlText) ? $urlText: $inspiration['campaign_url']; ?>
                            <?php $inspUrl = !empty($insp['url']) ? $insp['url'] : $campaignUrl; ?>

                            <div class="item">
                                <?php if(!empty($inspUrl)): ?><a href="<?php echo $inspUrl; ?>"><?php endif; // A1 OPEN ?>

                                    <img src="<?php echo Mage::getBaseUrl('media')  . $this->getImageResizePath($inspirationType).$insp['path']; ?>">
                                    <?php if(!empty($insp['url'])): // 5 START ?>
                                    <div class="carousel-caption">
                                        <?php $showCaptions = false; ?>
                                        <?php foreach($captions as $j => $caption): // 6 START ?>
                                            <?php  $captionText = $caption['text'];  ?>
                                            <?php if(!empty($captionText)): // 7 START ?>
                                                <?php $showCaptions = true; ?>
                                                <?php if(!empty($caption['url'])): // A2 OPEN ?>
                                                    <a href="<?php echo $caption['url']; ?>" class="<?php if($j > 1): ?>margin-top-20px<?php endif; ?>">
                                                <?php endif; ?>
                                                <span class="<?php if($j == 1): ?>title-caption<?php else: ?>body-caption<?php endif; ?>"><?php echo $caption['text']; ?></span>
                                                <?php if(!empty($caption['url'])): ?>
                                                    </a>
                                                <?php endif; // A2 CLOSE ?>
                                            <?php endif; // 7 END ?>
                                        <?php endforeach; // 6 END ?>
                                        <?php unset($j); ?>

                                        <?php if($showCaptions): ?>
                                            <a href="<?php echo $inspUrl; ?>">
                                                <span class="seemore-caption"><?php echo $bannerHelper->__("see"); ?> &gt;</span>
                                            </a>
                                        <?php endif; ?>
                                    </div>
                                    <?php endif; // 5 END ?>
                                <?php if(!empty($inspUrl)): ?></a><?php endif; // A1 CLOSE ?>
                            </div>
                        <?php endforeach; ?>
                    <?php endif; // 3 END ?>
                <?php endforeach; // 2 END ?>
            </div>
        </div>
    </section>
</div>

<?php endif; // 1 END ?>
