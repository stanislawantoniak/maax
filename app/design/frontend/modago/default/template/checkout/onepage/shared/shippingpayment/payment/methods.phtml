<?php /* @var $this Zolago_Modago_Block_Checkout_Onepage_Shared_Shippingpayment_Payment_Methods*/  ?>
<?php
$methods = $this->getMethods();
$oneMethod = count($methods) <= 1;
?>

<?php if (empty($methods)): ?>
    <?php echo $this->__('No Payment Methods') ?>
<?php else: ?>
    <!--        Selected payment-->
    <div class="top-panel" style="display: none;">
        <!--        <h4 class="default">TWÓJ DOMYŚLNY SPOSÓB PŁATNOŚCI</h4>-->
        <div class="row">
            <div class="col-xs-6">
                <dl>
                    <dt></dt>
                    <dd></dd>
                </dl>
            </div>
            <div class="col-xs-6 default_pay_selected_bank">
                <figure></figure>
            </div>
        </div>
    </div>
    <!--        Selected payment-->
    <?php
    foreach ($methods as $_method):
        $_code = $_method->getCode();
        ?>

        <div class="panel panel-default">
            <div class="panel-body">
                <div class="form-group form-radio">
                    <?php if(!$oneMethod): ?>
                        <input id="p_method_<?php echo $_code ?>"
                               value="<?php echo $_code ?>"
                               type="radio"
                               name="payment[method]"
                               title="<?php echo $this->escapeHtml($_method->getTitle()) ?>"
                               data-payment-method="<?php echo $this->escapeHtml($_method->getTitle()) ?>"
                               data-online="<?php echo $this->getIsOnline($_method) ?>"
                               <?php if($this->getSelectedMethodCode()==$_code): ?>checked="checked"<?php endif; ?>
                               class="css-radio payment-method"
                               required="required"  />
                    <?php else: ?>
                        <span class="no-display">
							<input id="p_method_<?php echo $_code ?>"
                                   value="<?php echo $_code ?>"
                                   data-payment-method="<?php echo $this->escapeHtml($_method->getTitle()) ?>"
                                   data-online="<?php echo $this->getIsOnline($_method) ?>"
                                   type="radio"
                                   name="payment[method]"
                                   checked="checked"
                                   class="radio payment-method" /></span>
                        <?php $oneMethod = $_code; ?>
                    <?php endif; ?>
                    <label class="css-label clearfix" for="p_method_<?php echo $_code ?>">
                        <span class="pull-left">
                            <strong><?php echo $this->escapeHtml($this->getMethodTitle($_method)) ?></strong>
                            <br>
                            Payment description here
                            <?php echo $this->getMethodLabelAfterHtml($_method) ?>
                        </span>
                        <?php $paymentIcons = $this->getPaymentMethodIcon($_code); ?>
                        <?php if (!empty($paymentIcons)): ?>
                            <?php foreach ($paymentIcons as $paymentIcon): ?>
                                <img alt="" src="<?php echo $paymentIcon; ?>" class="pull-right flag_pay_method" />
                            <?php endforeach; ?>
                        <?php endif; ?>
                    </label>
                </div>

                <?php if ($html = $this->getPaymentMethodFormHtml($_method)): ?>
                    <?php echo $html; ?>
                <?php endif; ?>

            </div>
        </div>

    <?php endforeach; ?>

<?php    endif; ?>
<?php echo $this->getChildChildHtml('additional'); ?>
<script type="text/javascript">
    //<![CDATA[
    //    jQuery('[name="payment[method]"]:checked').parents('.form-group').find('.selected_bank').show();
    //
    //    jQuery('[name="payment[method]"]').click(function () {
    //        if (jQuery(this).is(':checked')) {
    //            jQuery('.default_pay .form-group .selected_bank').hide();
    //            jQuery('.default_pay .form-group').find('.selected_bank ul input[type="radio"]').attr("disabled", "disabled").prop("disabled",true);
    //            jQuery(this).parents('.form-group').find('.selected_bank ul input[type="radio"]').attr("disabled", "").prop("disabled",false);
    //            jQuery(this).parents('.form-group').find('.selected_bank').show();
    //
    //        } else {
    //            jQuery(this).parents('.form-group').find('.selected_bank').hide();
    //        }
    //    })


    var default_pay_bank = jQuery('.default_pay input[name="payment[method]"]');
    jQuery('body').find('.default_pay input[name="payment[method]"]:checked').closest('.panel').addClass('payment-selected');


    jQuery(default_pay_bank).on('change', function(){
        jQuery(default_pay_bank).closest('.panel').removeClass('payment-selected');
        jQuery(this).closest('.panel').addClass('payment-selected');
        jQuery('.selected_bank').hide();
        jQuery(this).closest('.form-group').next('.selected_bank').show();
    });

    //]]>
</script>