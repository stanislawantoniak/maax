<?php
/* @var $this Zolago_Modago_Block_Home_Vendor */
$vendors = $this->getVendorColleciton();

$config = json_decode(Mage::getStoreConfig('design/popular_brands/popular_brands_config'), true);
// Const
// Max rows for columns calculated from css
$cMax8 = $config[8] * 8;
$cMax7 = $config[7] * 7;
$cMax6 = $config[6] * 6;
$cMax5 = $config[5] * 5;
$cMax4 = $config[4] * 4;
$cMax3 = $config[3] * 3;
$cMax2 = $config[2] * 2;

?>

<?php if (count($vendors) > 0) : ?>
	<section id="popular-brands">
		<div class="container-fluid">
			<div class="col-sm-12 vendor-logo-container">
				<div class="row">
					<div>
						<div class="vendor-logo-items">
							<h3><?php echo $this->__("popular brands"); ?></h3>
							<?php $n = 1; ?>
							<?php $vendorsCount = Mage::getStoreConfig('design/popular_brands/popular_brands_count');
							$makeFakeLoop = count($vendors) < $vendorsCount;
							if ($makeFakeLoop) {
								$lastVendor = new stdClass();
							}
							?>

							<?php foreach ($vendors as $v): ?>
								<div
									class="col-xxs col-xxs-landscape col-xs-4 col-xs-landscape col-sm-2 col-sm-landscape col-md-2 col-lg-3-eight vendor-logo-item
									<?php
                                    echo $n <= $cMax2 ? '' : 'hidden-2 ';
                                    echo $n <= $cMax3 ? '' : 'hidden-3 ';
                                    echo $n <= $cMax4 ? '' : 'hidden-4 ';
                                    echo $n <= $cMax5 ? '' : 'hidden-5 ';
                                    echo $n <= $cMax6 ? '' : 'hidden-6 ';
                                    echo $n <= $cMax7 ? '' : 'hidden-7 ';
                                    echo $n <= $cMax8 ? '' : 'hidden-8 ';
                                    ?>
									">
									<a href="<?php echo $this->getVendorBaseUrl($v); ?>">
										<span class="pop-shop-img-wr">
											<img src="<?php echo $this->getVendorResizedLogoUrl($v, 100, 44); ?>" alt="">
										</span>
										<span class="vendor-logo-item-name">
											<?php echo $this->getVendorName($v); ?> &gt;
										</span>
									</a>
								</div>

								<?php if ($n % 2 == 0): ?>
									<div class="clearfix visible-xxs"></div>
								<?php endif; ?>

								<?php if ($n % 3 == 0): ?>
									<div class="clearfix visible-xs"></div>
								<?php endif; ?>

								<?php if ($n % 4 == 0): ?>
									<div class="clearfix visible-xss-landscape"></div>
								<?php endif; ?>

								<?php if ($n % 5 == 0): ?>
									<div class="clearfix visible-xs-landscape"></div>
								<?php endif; ?>

								<?php if ($n % 6 == 0): ?>
									<div class="clearfix visible-sm"></div>
									<div class="clearfix visible-md"></div>
								<?php endif; ?>

								<?php if ($n % 7 == 0): ?>
									<div class="clearfix visible-sm-landscape"></div>
								<?php endif; ?>

								<?php if ($n % 8 == 0): ?>
									<div class="clearfix visible-lg"></div>
								<?php endif; ?>

								<!--cache last element for  fake loop only for testing!!!-->
								<?php if ($makeFakeLoop && $n == count($vendors)) {
									$lastVendor = $v;
								}?>
								<!--cache last element for  fake loop only for testing!!!-->

								<?php $n++; ?>
							<?php endforeach; ?>

							<!--                        fake loop only for testing!!!-->
							<?php if ($makeFakeLoop): ?>
								<?php for ($i = (count($vendors) + 1); $i <= $vendorsCount; $i++): ?>
									<div
										class="col-xxs col-xxs-landscape col-xs-4 col-xs-landscape col-sm-2 col-sm-landscape col-md-2 col-lg-3-eight vendor-logo-item
										<?php
                                        echo $n <= $cMax2 ? '' : 'hidden-2 ';
                                        echo $n <= $cMax3 ? '' : 'hidden-3 ';
                                        echo $n <= $cMax4 ? '' : 'hidden-4 ';
                                        echo $n <= $cMax5 ? '' : 'hidden-5 ';
                                        echo $n <= $cMax6 ? '' : 'hidden-6 ';
                                        echo $n <= $cMax7 ? '' : 'hidden-7 ';
                                        echo $n <= $cMax8 ? '' : 'hidden-8 ';
                                        ?>
										">
										<a href="<?php echo $this->getVendorBaseUrl($lastVendor); ?>">
                                        <span class="pop-shop-img-wr">
                                            <img src="<?php echo $this->getVendorResizedLogoUrl($lastVendor, 100, 44); ?>" alt="">
                                        </span>
                                        <span class="vendor-logo-item-name">
                                            <?php echo $this->getVendorName($lastVendor); ?> &gt;
                                        </span>
										</a>
									</div>

									<?php if ($n % 2 == 0): ?>
										<div class="clearfix visible-xxs"></div>
									<?php endif; ?>

									<?php if ($n % 3 == 0): ?>
										<div class="clearfix visible-xs"></div>
									<?php endif; ?>

									<?php if ($n % 4 == 0): ?>
										<div class="clearfix visible-xss-landscape"></div>
									<?php endif; ?>

									<?php if ($n % 5 == 0): ?>
										<div class="clearfix visible-xs-landscape"></div>
									<?php endif; ?>

									<?php if ($n % 6 == 0): ?>
										<div class="clearfix visible-sm"></div>
										<div class="clearfix visible-md"></div>
									<?php endif; ?>

									<?php if ($n % 7 == 0): ?>
										<div class="clearfix visible-sm-landscape"></div>
									<?php endif; ?>

									<?php if ($n % 8 == 0): ?>
										<div class="clearfix visible-lg"></div>
									<?php endif; ?>

									<?php $n++; ?>
								<?php endfor; ?>
							<?php endif; ?>
							<!--                        fake loop only for testing!!!-->
						</div>
					</div>
				</div>
				<a class="pop-shop-seemore" href="<?php echo $this->getViewMoreUrl(); ?>">
					<?php echo $this->__("see more brands"); ?>
				</a>
			</div>
		</div>
	</section>
<?php endif; ?>
